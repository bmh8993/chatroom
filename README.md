# chatroom

![Client-Server Architecture](https://user-images.githubusercontent.com/45564139/97934603-83a95500-1db9-11eb-8639-32a9f87717ba.png)

서버에는 많은 유저가 접근 할 수 있는데, 이 프로젝트에서는 여러 유저가 real-time으로 대화가 가능하도록 만들어보려고한다.<br>
client가 chatroom server로 메세지를 보내면, 서버는 커넥션이 되어져 있는 모든 유저에게 메세지를 공유할 것이다.

## Protocols

네트워크를 통한 통신은 프로토콜 스택이라고 부르는 것을 사용하는데, 그 프로토콜을 통해서 간단한 대화 위에 높은 수준의 정교한 대화를 구현할 수 잇습니다.
네트워크 레이어는 OSI 모델과 TCP/IP 모델로 표현 될 수 있습니다. 각각의 네트워크 계층은 계층 별 네트워크 프로토콜 그룹에 해당한다.

![protocol stack](https://user-images.githubusercontent.com/45564139/97935695-a8eb9280-1dbc-11eb-9c37-5344d74d7e87.png)

이 프로그램의 목적을 위해서는 하위 수준의 프로토콜에 대해 걱정할 필요는 없지만, TCP라고 불리는 프로토콜이 사용된다는 것은 알아야한다.

```
TCP, UDP의 하위 layer가 IP
gateway에 해당하는 패킷이면 gateway가 패킷을 분해하고 하위로 넘겨줌
IP의 용도는 여기서 끝
이제 TCP or UDP를 만나게 되는데 거기에는 port 정보가 들어있다
수신자 쪽에서 패킷(데이터가 들어있는)을 buffer에 계속 쌓아둘 것이다.
----
IP(internet protocol)
호스트 간의 통신만을 담당
택배로 비유하면 내용물의 상태나 그 주소에 수취인이 있는지 등은 고려하지
않고 일단 배송요청이 오면 내용물을 받기로 되어져있는 주소로 보내는것
즉, 신뢰성과 연결에 대한 보장을 하지 않는다

======================
통신할 때에 문제점
1. 지연시간 발생
2. 연결을 보장할 수 없다.
3. 순서를 보장할 수 없다.
4. 패킷이 유실되어 수신자쪽에 100프로 전달했다고 보장할 수 없다.

TCP
하드웨어(NIC와 같은 기계자체에서)에서 문제점들을 보장해주자
1. 연결 유무를 확인할 수 있도록(연결을 보장하는 것은 아니다!)
	- 연결: 추상적으로 연결되어져 있다고 생각하자(광케이블로 연결된게 아님! 인터넷으로 연결!)
	- 프로그래머가 어떻게 연결을 알 수 있을까?
	- 3way handshake(3방향 악수)
		- request, request_ok, request_ok를 잘 받았다.
2. 패킷의 순서를 보장해주자
	- 순서가 섞이면 메세지의 내용을 잘못해석할 수 있다.
	- 그렇기 때문에 패킷에 번호를 붙여서 보내준다.
3. 패킷의 송신(유실이 안되도록) 보장
	- 1,2,3,4를 보냈을 때에 3번이 유실되면
	- 3번을 다시 보내라는 요청을 보내게 되고
	- 3번이 올때까지 기다렸다가 모두 도착하면 프로그램이 가능하도록 진행

UDP
- 연결 유무 없다
- 순서 보장 없다
- 송신 보장 없다

그러면 UDP 왜쓸까?
- TCP의 경우 한번의 요청에 대해서 3번의 handshake가 발생해야함
- 느리다!!!!

UDP는 빠르다, 유실이 확률적으로 7%
지연시간이 빠르다

하지만 유실은 크리티컬한 요소이므로 Reliable UDP를 만들었다.(software이다)
안정성과 성능을 반비례로 필요에 따라 조절해가면서 사용
```
